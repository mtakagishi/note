*********************************************
Azure Data Factory
*********************************************
Last Updated on 2021-09-25

Azure Data Factoryとは
==================================
* Azure 提供のデータの移動や変換を自動化するフル マネージドのクラウドベースのデータ統合 ETL サービス

主要コンポーネント
==================================
パイプライン
  1つの作業単位を実行する複数のアクティビティ論理グループからなる論理グループ
アクティビティ
  パイプライン内の処理ステップ

  3種のアクティビティ
    * データ移動アクティビティ
    * データ変換アクティビティ
    * 制御アクティビティ

データセット
  データ ストア内のデータ構造を表したもの
リンクされたサービス
  Data Factory が外部リソースに接続するために必要な接続情報
データフローのマッピング
  コーディング不要のデータ変換ロジックのグラフ（データ構造＝ノードと連結で表現された型）
統合ランタイム
  アクティビティとリンクされたサービスとの橋渡しをする役割

データファクトリの作成
==================================
公式ドキュメントのクイックスタートで8種の異なるアプローチで主要手順を解説。アプローチごとに独立のチュートリアルになっているので用途に合った手段を選んで体験できる。

データファクトリ作成の主要手順
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
* 前提条件の準備
* Data Factory作成
* リンクサービスの作成
* データセットの作成
* パイプラインの作成
* パイプライン実行・監視
* 結果確認

データファクトリ作成の8種のアプローチ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Azure Data Factory UI
  Azure Data Factory Studio　を利用する方法
データのコピーツール
  Azure Data Factory のホーム ページにある[取り込み] タイルから作成する方法
Azure CLI
  Azure Cloud Shell からBash環境で作成する方法
Azure PowerShell
  Azure PowerShell をインストールして、Powershellターミナルから作成する方法。
.NET
  .NET SDK を使用してプログラムからから操作する方法
Python
  Python用意されたazure-mgmt-resourceパッケージを用いて操作する方法
REST
  REST API を使用して Azure データ ファクトリを作成する方法
Resource Manager
  Azure Resource Manager テンプレート (ARM テンプレート) を使用する方法

データの変換
==================================
データ変換アプローチ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
データフローマッピング
  コードを記述しないグラフィカルなデータ変換ロジック
データラングリング
  Data FactoryではPower Query M 関数を利用できる。
外部リソースを利用する
  HDInsight クラスター
    * Hive クエリ
    * Pig クエリ
    * MapReduce プログラム
    * Hadoop Streaming プログラム
    * Spark プログラム
  ML Studio (classic) 
    予測分析ソリューション
  ストアド プロシージャ
    Transact-SQL
  Azure Data Lake Analytics クラスター
    U-SQL スクリプト
  Azure Databricks
    * Synapse Notebook
    * Spark Jar
    * Python

データフローマッピング
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
必須変換
  ソース変換
    各データ フローに少なくとも 1 つのシンク変換が必要。開始時に扱うデータ形状と読込み場所を指定。
  シンク変換
    各データ フローに少なくとも 1 つのシンク変換が必要。出力時に扱うデータ形状と書込み場所を指定。
複数の入力/出力
  新しいブランチ
    同じデータについて新しい分岐を追加。
  Exists
    存在するかどうかを確認
  条件分割
    一致条件で処理フロー分割しておき、一致条件に基づくようにデータ振分け分割する。
  Join
    2 つのソースまたはストリームのデータを結合変換。内部結合・右外部結合・左外部結合・完全外部結合・カスタムクロス結合
  Union (結合)
    複数のデータ ストリームの SQL Union を和集合変換からの新しい出力として使用
  Lookup
    別のソースからデータを参照
行修飾
  行の変更
    挿入、削除、更新および upsert 
  Assert
    条件に基づいて、行をフィルター  
  Sort
    現在のデータ ストリームで受信行を並べ替える
スキーマ修飾
  選択変換
    行データを変更するものではなく、どの列が下流に伝達されるかを選択する
  集計
    グループ化される、SUM、MIN、MAX、COUNT などの集計
  派生列
    新しい列を生成するか、既存のフィールドを変更
  代理キー
    ビジネス以外の任意のキー値のインクリメントを追加
  順位
    並べ替え条件に基づいて順序付けされた順位付けを生成
  フラット化
    階層構造体の中で配列値を取得し、それらを個々の行に展開
  ピボット
    1 つの列の一意の行値から複数の列を作成し集計
  ピボット解除
    正規化されていないデータセットをより正規化されたバージョンに変換
  ウィンド  ウ
    ウィンドウ ベースの集計
  Parse
    列データを Json または区切りテキストに解析

参考リンク
==================================
* `公式ページ <https://azure.microsoft.com/ja-jp/services/data-factory/>`_ 
* `公式ドキュメント <https://docs.microsoft.com/ja-jp/azure/data-factory/>`_ 
