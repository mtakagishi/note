********************************
RANCHERのコンセプト
********************************
Last Updated on 2021-04-17


Dockerについて
================================================
* コンテナ実行環境のデファクトスタンダード
* DockerfilesからDockerイメージをビルドする
* Docker Hubに代表されるレジストリから配布することができる

.. note::

  Kubernetesの安定化に伴い、Docker Swarm は Rancher1.6まで、Rancher2.0からは利用できない。

Kubernetesについて
================================================
* コンテナクラスタ管理のデファクトスタンダード
* アプリケーション構成となるコンテナやリソースや位置をYAML形式で指定。
* スケジュール・冗長性・死活監視・構成管理などの機能を持つ。

.. note::

  numeronym（ヌメロニム）という長い英単語を数字で省略する表現で、Kubernetes　を 「K + 8文字 + S」 で K8s と略す表記も頻出する。

Kubernetesクラスタとは何か
================================================
* クラスタは1つのシステムとして成立するコンピュータリソースのひと塊
* Kubernetesクラスタは、オーケストレーション機能によりデプロイ・自動復旧・スケール制御などのシステム安定運用のための運用作業を自動化する。

Kubernetesクラスタにおけるノードの役割
================================================
* クラスタのコンピューティングリソースそれぞれをノードと呼ぶ。
* ノードは物理サーバや仮想サーバのような単位と解釈できる。
* ノードには3つのクラスがある。

  * etcdノード
  * control planeノード
  * workerノード

* クラスタは3クラスノードをそれぞれ最低ひとつずつ必要

etcdノード
------------------------------
* Rancherはetcdをデータストアとして使う
* Kubernetesはクラスタ状態をetcdで維持し、etcdノードはetcd databaseを実行する。
* etcd database は 分散型key-valueストアで、クラスタ間の調整情報や状態管理を司る。
* etcd 障害対策を踏まえ複数ノードが望ましい。
* クラスタには正常動作するetcdの必要最低数があり、クラスタ内のnメンバに対し必要なetcdは、(n/2) + 1
* 通常、小さいクラスタで3個、大きいクラスタで5個で十分

control planeノード
------------------------------
* APIサービス、スケジューラ、コントローラを実行する。
* これらの機能により、あらかじめ設定した状態維持に必要な定例作業が自動実行される。
* 全てのクラスタ情報はetcdノードにあり、control planeノードはステートレスで実行される。
* control planeノードは2つ以上の冗長かを推奨する。単独でも実行できる。
* control Planeノードとetcdノードは、単一ノードで役割の共有が可能。

workerノード
------------------------------
* workerノードは kubelets、workloadsを実行する。
* ストレージドライバ、ネットワークドライバ、入力コントローラを必要に応じて実行する
* workloadsの実行に必要な数のworkerノードを作成する。

kubelets
^^^^^^^^^^^^
* ノードの状態監視

workloads
^^^^^^^^^^^^
* アプリケーションが動作するコンテナやポッドなど

Helmについて
================================================
* HelmはKubernetes向けのパッケージ管理ツール
* Helm chartは、Kubernetesに必要なYAMLマニフェストを配布する。
* Helmにより静的なだけでない独自のデプロイカタログを作成できる。

.. |date| date::
